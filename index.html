<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>GPS Compass by Pederzent</title>
        <style>
            body {
                background: radial-gradient(circle at center, #0a0a0a, #000);
                color: #0f0;
                font-family: monospace;
                text-align: center;
                margin: 0;
                height: 100vh;
                overflow: hidden;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            .compass-wrapper {
                position: relative;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            /* Floating cyan shadow beneath compass */
            .compass-wrapper::before {
                content: "";
                position: absolute;
                bottom: -20px;
                width: 220px;
                height: 30px;
                background: radial-gradient(
                    ellipse at center,
                    rgba(0, 255, 255, 0.15),
                    transparent 70%
                );
                filter: blur(10px);
                border-radius: 50%;
                z-index: 0;
            }
            .compass {
                position: relative;
                width: 250px;
                height: 250px;
                border-radius: 50%;
                background: radial-gradient(
                    circle at center,
                    #111 0%,
                    #000 90%
                );
                display: flex;
                justify-content: center;
                align-items: center;
                box-shadow:
                    inset 0 5px 15px rgba(0, 255, 255, 0.3),
                    inset 0 -5px 20px rgba(0, 128, 128, 0.6),
                    0 5px 25px rgba(0, 255, 255, 0.2),
                    0 -5px 30px rgba(0, 255, 255, 0.15);
                border: 6px solid transparent;
                background-clip: padding-box;
                z-index: 1;
                animation: pulseGlow 6s ease-in-out infinite;
            }
            /* Breathing cyan glow animation */
            @keyframes pulseGlow {
                0%,
                100% {
                    box-shadow:
                        inset 0 5px 15px rgba(0, 255, 255, 0.3),
                        inset 0 -5px 20px rgba(0, 128, 128, 0.6),
                        0 5px 25px rgba(0, 255, 255, 0.2),
                        0 -5px 30px rgba(0, 255, 255, 0.15),
                        0 0 15px rgba(0, 255, 255, 0.2);
                }
                50% {
                    box-shadow:
                        inset 0 6px 20px rgba(0, 255, 255, 0.5),
                        inset 0 -6px 25px rgba(0, 128, 128, 0.7),
                        0 0 40px rgba(0, 255, 255, 0.5),
                        0 0 70px rgba(0, 255, 255, 0.3);
                }
            }
            /* Metallic 3D rim */
            .compass::before {
                content: "";
                position: absolute;
                inset: -6px;
                border-radius: 50%;
                background: linear-gradient(145deg, #033, #0aa, #011);
                box-shadow:
                    inset 2px 2px 5px rgba(255, 255, 255, 0.3),
                    inset -4px -4px 10px rgba(0, 0, 0, 0.7),
                    0 0 25px rgba(0, 255, 255, 0.4);
                z-index: -2;
            }
            /* Thin glass reflection */
            .compass::after {
                content: "";
                position: absolute;
                inset: 0;
                border-radius: 50%;
                background: radial-gradient(
                    circle at 30% 20%,
                    rgba(255, 255, 255, 0.25) 0%,
                    rgba(255, 255, 255, 0.08) 30%,
                    rgba(255, 255, 255, 0.02) 60%,
                    rgba(255, 255, 255, 0) 100%
                );
                transform: rotate(-15deg);
                filter: blur(1px);
                pointer-events: none;
                z-index: 10;
            }
            /* Needle shaft */
            .needle {
                position: absolute;
                width: 6px;
                height: 100px; /* Adjusted to end before the ring */
                background: linear-gradient(90deg, #800, #f00, #800);
                transform-origin: 50% 100%;
                border-radius: 3px;
                bottom: 50%;
                left: 50%;
                box-shadow:
                    0 0 10px rgba(255, 0, 0, 0.5),
                    0 0 25px rgba(255, 0, 0, 0.2),
                    2px 0 4px rgba(0, 0, 0, 0.3); /* Slight shadow for 3D depth */
            }
            /* Arrowhead */
            .needle::before {
                content: "";
                position: absolute;
                top: -12px;
                left: -5px;
                width: 0;
                height: 0;
                border-left: 8px solid transparent;
                border-right: 8px solid transparent;
                border-bottom: 12px solid #f00;
                filter: drop-shadow(0 0 5px rgba(255, 0, 0, 0.5));
            }
            /* Direction labels */
            .labels {
                position: absolute;
                width: 100%;
                height: 100%;
                font-size: 20px;
                font-weight: bold;
                color: #0ff;
                text-shadow:
                    0 0 8px #0ff,
                    0 0 20px #0ff8;
                pointer-events: none;
            }
            .labels div {
                position: absolute;
                transform: translate(-50%, -50%);
            }
            .N {
                top: 6%;
                left: 50%;
            }
            .S {
                bottom: 4%;
                left: 50%;
            }
            .E {
                top: 50%;
                right: 4%;
                transform: translate(50%, -50%);
            }
            .W {
                top: 50%;
                left: 6%;
                transform: translate(-50%, -50%);
            }
            .heading-display {
                position: absolute;
                top: 40%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 18px;
                color: #0ff;
                text-shadow: 0 0 5px #0ff;
                pointer-events: none;
            }
            .speed-display {
                position: absolute;
                top: 60%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 18px;
                color: #0ff;
                text-shadow: 0 0 5px #0ff;
                pointer-events: none;
            }
            pre {
                margin-top: 20px;
                color: #0f0;
                text-align: left;
                white-space: pre-line;
                font-size: 14px; /* Fixed font size */
                background: rgba(0, 20, 20, 0.3);
                padding: 10px 20px;
                border-radius: 10px;
                box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
            }
            button {
                margin: 0 5px;
                background: #022;
                color: #0ff;
                border: 1px solid #0ff;
                border-radius: 8px;
                padding: 8px 16px;
                cursor: pointer;
                font-size: 14px;
                transition:
                    background 0.2s,
                    transform 0.1s;
            }
            button:hover {
                background: #044;
                transform: scale(1.05);
            }
        </style>
    </head>
    <body>
        <div class="compass-wrapper">
            <div class="compass" id="compass">
                <div class="needle" id="needle"></div>
                <div class="labels" id="labels">
                    <div class="N">N</div>
                    <div class="S">S</div>
                    <div class="E">E</div>
                    <div class="W">W</div>
                </div>
                <div class="heading-display" id="heading-display">N/A</div>
                <div class="speed-display" id="speed-display">N/A</div>
            </div>
        </div>
        <pre id="output">Waiting for GPS heading...</pre>
        <button id="toggle-mode">Switch to Heading-Up Mode</button>
        <script>
            const needle = document.getElementById("needle");
            const output = document.getElementById("output");
            const headingDisplay = document.getElementById("heading-display");
            const speedDisplay = document.getElementById("speed-display");
            const labels = document.getElementById("labels");
            const toggleButton = document.getElementById("toggle-mode");
            let currentHeading = 0;
            let targetHeading = 0;
            let isFixedCompass = true;
            toggleButton.addEventListener("click", () => {
                isFixedCompass = !isFixedCompass;
                toggleButton.textContent = isFixedCompass
                    ? "Switch to Heading-Up Mode"
                    : "Switch to North-Up Mode";
            });
            // Smooth rotation interpolation
            function smoothRotate() {
                const diff =
                    ((targetHeading - currentHeading + 540) % 360) - 180;
                currentHeading = (currentHeading + diff * 0.1 + 360) % 360;
                if (isFixedCompass) {
                    needle.style.transform = `translateX(-50%) rotate(${currentHeading}deg)`;
                    labels.style.transform = `rotate(0deg)`;
                } else {
                    needle.style.transform = `translateX(-50%) rotate(0deg)`;
                    labels.style.transform = `rotate(${-currentHeading}deg)`;
                }
                requestAnimationFrame(smoothRotate);
            }
            smoothRotate();
            function updateTime() {
                const now = new Date();
                const hh = String(now.getHours()).padStart(2, "0");
                const mm = String(now.getMinutes()).padStart(2, "0");
                const ss = String(now.getSeconds()).padStart(2, "0");
                return `${hh}:${mm}:${ss}`;
            }
            if ("geolocation" in navigator) {
                navigator.geolocation.watchPosition(
                    (pos) => {
                        const { heading, speed } = pos.coords;
                        if (heading !== null) targetHeading = heading;
                        headingDisplay.textContent =
                            heading !== null ? heading.toFixed(1) : "N/A";
                        speedDisplay.textContent =
                            speed !== null ? (speed * 3.6).toFixed(1) : "N/A";
                        output.textContent = `Local Time: ${updateTime()}`;
                    },
                    (err) => (output.textContent = `Error: ${err.message}`),
                    { enableHighAccuracy: true, maximumAge: 0 },
                );
            } else {
                output.textContent = "Geolocation not supported.";
            }
            setInterval(() => {
                output.textContent = `Local Time: ${updateTime()}`;
            }, 1000);
        </script>
    </body>
</html>
